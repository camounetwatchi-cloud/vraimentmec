files:
  "/tmp/download_stockfish.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      STOCKFISH_DIR="/var/app/current/engine"
      STOCKFISH_URL="https://github.com/official-stockfish/Stockfish/releases/download/sf_16.1/stockfish-ubuntu-x86-64-avx2.tar"
      
      echo "Creating Stockfish directory..."
      mkdir -p "$STOCKFISH_DIR"
      
      echo "Downloading Stockfish..."
      cd /tmp
      wget -q "$STOCKFISH_URL" -O stockfish.tar
      
      echo "Extracting Stockfish..."
      tar -xf stockfish.tar
      
      echo "Moving Stockfish binary..."
      mv stockfish/stockfish-ubuntu-x86-64-avx2 "$STOCKFISH_DIR/stockfish"
      
      echo "Setting permissions..."
      chmod +x "$STOCKFISH_DIR/stockfish"
      
      echo "Cleaning up..."
      rm -rf /tmp/stockfish*
      
      echo "Stockfish installation complete!"
      ls -la "$STOCKFISH_DIR"

container_commands:
  01_install_stockfish:
    command: "/tmp/download_stockfish.sh"
    leader_only: true
